import{a as _,n as U,r as W,b as u,t as E,o as x,v as l,p as w,f as i,h as f,q as c,u as v,w as j,e as kt,j as e,s as A,g as Pt,x as Dt}from"./_DNIqJMnq.js";import{_ as R,a as L,b as G,c as F}from"./_z_vb491r.js";const zt=`${R}${R}<div class=game><div class=view><div></div><!></div></div>`,Ht=`/${L}&/${L}&D D b%m`;let a=function(t){return t[t.Empty=0]="Empty",t[t.Tile=1]="Tile",t[t.Spikes=2]="Spikes",t[t.Start=3]="Start",t[t.Goal=4]="Goal",t[t.DirectLeft=5]="DirectLeft",t[t.DirectRight=6]="DirectRight",t[t.Spring=7]="Spring",t}({});const Z=mt,b=.015,$=.1,V=1e3/60,T=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),p=i(4,0,void 0,()=>T),tt=i(3,0,void 0,()=>T),Et=_("f4",u("<div class=spring></div>"," ",void 0,()=>[p,tt])),ot=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),st=i(4,0,void 0,()=>ot),nt=i(3,0,void 0,()=>ot),wt=_("f5",u("<div class=right-sign></div>"," ",void 0,()=>[st,nt])),at=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),lt=i(4,0,void 0,()=>at),et=i(3,0,void 0,()=>at),jt=_("f6",u("<div class=left-sign></div>"," ",void 0,()=>[lt,et])),it=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),rt=i(4,0,void 0,()=>it),dt=i(3,0,void 0,()=>it),At=_("f7",u("<div class=goal></div>"," ",void 0,()=>[rt,dt])),_t=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),ft=i(4,0,void 0,()=>_t),ct=i(3,0,void 0,()=>_t),Rt=_("f8",u("<div class=spikes></div>"," ",void 0,()=>[ft,ct])),vt=c(2,t=>{const{_:{3:o,4:s}}=t;v(t[0],{"--x":o,"--y":s})}),yt=i(4,0,void 0,()=>vt),ut=i(3,0,void 0,()=>vt),Lt=_("f9",u("<div class=tile></div>"," ",void 0,()=>[yt,ut])),Y=Pt(0,0),C=l(5,(t,o)=>Y(t,o===a.Tile?Lt:o===a.Spikes?Rt:o===a.Goal?At:o===a.DirectLeft?jt:o===a.DirectRight?wt:o===a.Spring?Et:null),()=>Y),X=l(4,0,()=>f([e(yt,0),e(ft,0),e(rt,0),e(lt,0),e(st,0),e(p,0)])),q=l(3,0,()=>f([e(ut,0),e(ct,0),e(dt,0),e(et,0),e(nt,0),e(tt,0)])),I=l(2,(t,o)=>{q(t,o.x),X(t,o.y),C(t,o.type)},()=>f([q,X,C])),Gt=l(1,(t,o)=>I(t,o?.[0]),()=>I),Ft=_("f12",u("<!><!><!---->","D%",void 0,void 0,()=>Gt)),Vt=U("f10",(t,{7:o,12:s,14:y,15:d,16:h,17:$t,18:Bt,19:bt,20:D,21:Mt})=>{if(h!==null){xt(t,!Mt);const St=Z();let g=h;if(g&&St-g>V){g+=V;let n=[y+bt,d+D];switch(o[Math.floor(n[1]+1)]?.[Math.floor(n[0]+.5)]===a.Tile?(m(t,$t?b*-16:0),n[1]=Math.floor(n[1])):m(t,D+b),(n[1]>o.length+10||o[Math.floor(n[1]+.5)]?.[Math.floor(n[0]+1)]===a.Tile||o[Math.floor(n[1]+.8)]?.[Math.floor(n[0]+.8)]===a.Tile||o[Math.floor(n[1])]?.[Math.floor(n[0]+.5)]===a.Tile||o[Math.floor(n[1]+.2)]?.[Math.floor(n[0]+.8)]===a.Tile||o[Math.floor(n[1]+.5)]?.[Math.floor(n[0]+.5)]===a.Spikes)&&(n=[...s],g=null,B(t,$),m(t,0),E(t[0],Bt+1)),o[Math.floor(n[1]+.5)]?.[Math.floor(n[0]+.5)]){case a.Goal:g=null,E(t[1],!0),window.location.href="/level/"+(+(t.$global.params.id??0)+1);break;case a.DirectLeft:B(t,-$);break;case a.DirectRight:B(t,$);break;case a.Spring:m(t,b*-26);break}S(t,n)}P(t,g)}}),r=c(10,t=>{Vt(t)}),k=c(3,t=>{H(t,ht(t)())},()=>H),gt=c(2,t=>{const{14:o,15:s}=t;v(t[2],{"--x":o,"--y":s})}),Yt=Dt(4,Ft),xt=x(21,0,()=>r),m=x(20,0,()=>r),B=x(19,(t,o)=>v(t[3],{"animation-duration":.15/Math.abs(o)+"s","animation-direction":o<0?"reverse":void 0}),()=>r),Ct=W("f2",l(18,0,()=>r)),M=x(17,0,()=>r),Xt=U("f11",(t,{16:o})=>{document.addEventListener("keydown",s=>{s.target instanceof Element&&s.target.matches("button, [role='button'], input, select, textarea")||s.key===" "&&(o===null?P(t,Z()):M(t,!0))},{signal:w(t,0)}),document.addEventListener("keyup",s=>{s.key===" "&&M(t,!1)},{signal:w(t,1)})}),P=x(16,(t,o)=>{j(t,0),j(t,1),kt(t[3],{ball:!0,moving:o!==null}),Xt(t)},()=>r),O=l(15,0,()=>f([r,gt])),qt=W("f3",(t,o)=>{}),z=l(14,0,()=>f([r,gt])),S=x(13,(t,o)=>{z(t,o?.[0]),O(t,o?.[1])},()=>f([z,O])),H=l(12,(t,o)=>S(t,[...o]),()=>f([r,S])),J=l(11,0,()=>k),K=l(10,0,()=>k),N=l(9,(t,o)=>{K(t,o?.length),J(t,o?.j)},()=>f([K,J])),Q=l(8,0,()=>k),Jt=l(7,(t,o)=>{Q(t,o?.length),N(t,o?.i),Yt(t,[o.flatMap((s,y)=>s.flatMap((d,h)=>d===a.Empty||d===a.Start?[]:[{x:h,y,type:d}]))])},()=>f([r,Q,N]));function Kt(t){A(t,0,Ct),G(t[0]),A(t,1,qt),G(t[1]),P(t,null),M(t,!1),F(t[0],{value:0,key:`level-${t.$global.params.id}-deaths`}),F(t[1],{value:!1,key:`level-${t.$global.params.id}-victory`}),B(t,$),m(t,0),xt(t,!0)}function mt(){return+document.timeline.currentTime}function ht({8:t,10:o,11:s}){return()=>{for(let y=0;y<t;y++)for(let d=0;d<o;d++)if(s===a.Start)return[d,y];return[0,0]}}_("f1",mt);_("f0",ht);export{zt as _,Ht as a,Kt as b,Jt as c};
//# sourceMappingURL=_CQ90rqTK.js.map
