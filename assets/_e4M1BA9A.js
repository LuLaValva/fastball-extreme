import{r as _,n as W,a as Z,b as y,t as j,o as m,v as e,p as B,f as i,h as f,q as c,u as v,w as A,e as kt,j as l,s as L,g as Pt,x as Et}from"./_ksheEKum.js";import{_ as R,a as G,b as F,c as V}from"./_D1pLKG-X.js";const zt=`${R}${R}<div class=game><div class=view><div></div><!></div></div>`,Ht=`/${G}&/${G}&D D b%m`;let a=function(t){return t[t.Empty=0]="Empty",t[t.Tile=1]="Tile",t[t.Spikes=2]="Spikes",t[t.Start=3]="Start",t[t.Goal=4]="Goal",t[t.DirectLeft=5]="DirectLeft",t[t.DirectRight=6]="DirectRight",t[t.Spring=7]="Spring",t}({});const P=xt,k=.015,b=.1,Y=1e3/60,T=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),p=i(4,0,void 0,()=>T),tt=i(3,0,void 0,()=>T),Dt=_("f4",y("<div class=spring></div>"," ",void 0,()=>[p,tt])),ot=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),nt=i(4,0,void 0,()=>ot),st=i(3,0,void 0,()=>ot),wt=_("f5",y("<div class=right-sign></div>"," ",void 0,()=>[nt,st])),at=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),et=i(4,0,void 0,()=>at),lt=i(3,0,void 0,()=>at),jt=_("f6",y("<div class=left-sign></div>"," ",void 0,()=>[et,lt])),it=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),rt=i(4,0,void 0,()=>it),dt=i(3,0,void 0,()=>it),At=_("f7",y("<div class=goal></div>"," ",void 0,()=>[rt,dt])),_t=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),ft=i(4,0,void 0,()=>_t),ct=i(3,0,void 0,()=>_t),Lt=_("f8",y("<div class=spikes></div>"," ",void 0,()=>[ft,ct])),vt=c(2,t=>{const{_:{3:o,4:n}}=t;v(t[0],{"--x":o,"--y":n})}),ut=i(4,0,void 0,()=>vt),yt=i(3,0,void 0,()=>vt),Rt=_("f9",y("<div class=tile></div>"," ",void 0,()=>[ut,yt])),C=Pt(0,0),X=e(5,(t,o)=>C(t,o===a.Tile?Rt:o===a.Spikes?Lt:o===a.Goal?At:o===a.DirectLeft?jt:o===a.DirectRight?wt:o===a.Spring?Dt:null),()=>C),q=e(4,0,()=>f([l(ut,0),l(ft,0),l(rt,0),l(et,0),l(nt,0),l(p,0)])),I=e(3,0,()=>f([l(yt,0),l(ct,0),l(dt,0),l(lt,0),l(st,0),l(tt,0)])),O=e(2,(t,o)=>{I(t,o.x),q(t,o.y),X(t,o.type)},()=>f([I,q,X])),Gt=e(1,(t,o)=>O(t,o?.[0]),()=>O),Ft=_("f12",y("<!><!><!---->","D%",void 0,void 0,()=>Gt)),Vt=W("f10",(t,{7:o,12:n,14:u,15:d,16:$,17:$t,18:Bt,19:bt,20:w,21:Mt})=>{if($!==null){mt(t,!Mt);const St=P();let g=$;if(g&&St-g>Y){g+=Y;let s=[u+bt,d+w];switch(o[Math.floor(s[1]+1)]?.[Math.floor(s[0]+.5)]===a.Tile?(x(t,$t?k*-16:0),s[1]=Math.floor(s[1])):x(t,w+k),(s[1]>o.length+10||o[Math.floor(s[1]+.5)]?.[Math.floor(s[0]+1)]===a.Tile||o[Math.floor(s[1]+.8)]?.[Math.floor(s[0]+.8)]===a.Tile||o[Math.floor(s[1])]?.[Math.floor(s[0]+.5)]===a.Tile||o[Math.floor(s[1]+.2)]?.[Math.floor(s[0]+.8)]===a.Tile||o[Math.floor(s[1]+.5)]?.[Math.floor(s[0]+.5)]===a.Spikes)&&(s=[...n],g=null,M(t,b),x(t,0),j(t[0],Bt+1)),o[Math.floor(s[1]+.5)]?.[Math.floor(s[0]+.5)]){case a.Goal:g=null,j(t[1],!0),window.location.href="/level/"+(+(t.$global.params.id??0)+1);break;case a.DirectLeft:M(t,-b);break;case a.DirectRight:M(t,b);break;case a.Spring:x(t,k*-26);break}E(t,s)}S(t,g)}}),r=c(10,t=>{Vt(t)}),D=c(3,t=>{J(t,ht(t)())},()=>J),gt=c(2,t=>{const{14:o,15:n}=t;v(t[2],{"--x":o,"--y":n})}),Yt=Et(4,Ft),mt=m(21,0,()=>r),x=m(20,0,()=>r),M=m(19,(t,o)=>v(t[3],{"animation-duration":.15/Math.abs(o)+"s","animation-direction":o<0?"reverse":void 0}),()=>r),Ct=Z("f2",e(18,0,()=>r)),h=m(17,0,()=>r),Xt=W("f11",(t,{16:o})=>{document.addEventListener("keydown",n=>{n.target instanceof Element&&n.target.matches("button, [role='button'], input, select, textarea")||n.key===" "&&(o===null?S(t,P()):h(t,!0))},{signal:B(t,0)}),document.addEventListener("keyup",n=>{n.key===" "&&h(t,!1)},{signal:B(t,1)}),document.addEventListener("pointerdown",n=>{n.target instanceof Element&&n.target.matches("button, [role='button'], input, select, textarea")||(o===null?S(t,P()):h(t,!0))},{signal:B(t,1)}),document.addEventListener("pointerup",n=>{h(t,!1)},{signal:B(t,1)})}),S=m(16,(t,o)=>{A(t,0),A(t,1),kt(t[3],{ball:!0,moving:o!==null}),Xt(t)},()=>r),z=e(15,0,()=>f([r,gt])),qt=Z("f3",(t,o)=>{}),H=e(14,0,()=>f([r,gt])),E=m(13,(t,o)=>{H(t,o?.[0]),z(t,o?.[1])},()=>f([H,z])),J=e(12,(t,o)=>E(t,[...o]),()=>f([r,E])),K=e(11,0,()=>D),N=e(10,0,()=>D),Q=e(9,(t,o)=>{N(t,o?.length),K(t,o?.j)},()=>f([N,K])),U=e(8,0,()=>D),Jt=e(7,(t,o)=>{U(t,o?.length),Q(t,o?.i),Yt(t,[o.flatMap((n,u)=>n.flatMap((d,$)=>d===a.Empty||d===a.Start?[]:[{x:$,y:u,type:d}]))])},()=>f([r,U,Q]));function Kt(t){L(t,0,Ct),F(t[0]),L(t,1,qt),F(t[1]),S(t,null),h(t,!1),V(t[0],{value:0,key:`level-${t.$global.params.id}-deaths`}),V(t[1],{value:!1,key:`level-${t.$global.params.id}-victory`}),M(t,b),x(t,0),mt(t,!0)}function xt(){return+document.timeline.currentTime}function ht({8:t,10:o,11:n}){return()=>{for(let u=0;u<t;u++)for(let d=0;d<o;d++)if(n===a.Start)return[d,u];return[0,0]}}_("f1",xt);_("f0",ht);export{zt as _,Ht as a,Kt as b,Jt as c};
//# sourceMappingURL=_e4M1BA9A.js.map
